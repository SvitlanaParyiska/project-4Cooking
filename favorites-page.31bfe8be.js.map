{"mappings":"qhBAAAA,EAAA,SAAAC,SAA8CC,KAAKC,MAAM,wJCAzDH,EAAA,S,MCAAI,EAAiB,IAAAC,IAAoBL,EAAA,SAAAM,QAA6C,SAAQC,OAAAC,KAAAC,KAAEC,W,8BCK5F,MAAMC,EAAO,CACXC,wBAAyBC,SAASC,cAAc,4BAChDC,qBAAsBF,SAASC,cAAc,2BAC7CE,aAAcH,SAASC,cAAc,sBAIvC,IAAIG,EAAe,GAkFnB,SAASC,EAAcC,GACrBR,EAAKI,qBAAqBK,UAAY,GACtC,MAAMC,EAAWF,EAAIG,SAAQ,EAACC,QAAEA,KAC9BA,EAAQC,KAAI,EAACC,IAAEA,EAAGC,MAAEA,EAAKC,SAAEA,EAAQC,YAAEA,EAAWC,QAAEA,EAASC,OAAAC,MACzD,MAAMC,EAAmB,kDACZC,EAAA7B,oCAEP8B,EAAqB,yDACdD,EAAA7B,oCAWb,MAAO,8CAA8CqB,qBAAuBE,sGAA6GE,sQAI1KI,EAAA7B,kLAMgCsB,gEACEE,yNAGmBG,EAAOI,QACvD,sHAvBpB,SAAuBL,GACrB,IAAIM,EAAQ,GACRC,EAAgBC,KAAKC,MAAMT,GAC/B,IAAK,IAAIU,EAAI,EAAGA,EAAI,EAAGA,IACrBJ,GAASI,EAAIH,EAAgBL,EAAmBE,EAElD,OAAOE,C,CAoBeK,CAAcV,kJAISN,+IAGvC,MAGZd,EAAKI,qBAAqBK,UAAYC,EAASqB,KAAK,G,CA/HtD/B,EAAKC,wBAAwB+B,iBAC3B,SAkEF,SAAmCC,GACjC,MAAMC,EAAmBD,EAAME,OAAOC,YAEtC,GAAyB,mBAArBF,EACF3B,EAAcD,OACT,CAILC,EAAc,CAHcD,EAAa+B,MACvCC,GAAOA,EAAIC,QAAUL,K,KAnE3BM,iBACE,MAAMC,GAAiB,EAAAC,EAAAC,MAXH,aAapB,GAAKF,GAA4C,IAA1BA,EAAeG,OAIpC,IACE,MAAMC,QAUZL,eAA0BM,GACxB,MAAMC,EACJ,0DACF,IACE,MAAMC,EAAgBF,EAAMjC,KAAI2B,MAAMS,UACbC,MAAM,GAAGH,IAAmBE,MACnCE,SAGlB,aADsBC,QAAQC,WAAWL,IAC1BnC,KAAIyC,GAAUA,EAAOC,O,CACpC,MACA,MAAM,IAAIC,MAAM,Q,EArBYC,CAAWhB,GACrCnC,EAwBN,SAA4BuC,GAC1B,MAAMa,EAAY,GAYlB,MAXyB,IACpB,IAAIC,IAAId,EAAYhC,KAAIyC,GAAUA,EAAOtC,aAG7B4C,SAAQ5C,IACvB,MAAM6C,EAAoBhB,EAAYiB,QACpCR,GAAUA,EAAOtC,WAAaA,IAEhC0C,EAAUK,KAAK,CAAExB,MAAOvB,EAAUJ,QAASiD,GAAoB,IAG1DH,C,CArCYM,CAAmBnB,GAwCxC,SAAyBrC,GACvB,MAAMyD,EAAezD,EAAIK,KACvB,EAAC0B,MAAEA,KAAY,4FACyCA,8BAG1DvC,EAAKC,wBAAwBQ,UAAY,kJAE5BwD,EAAalC,KAAK,K,CA/C3BmC,CAAgB5D,GAChBC,EAAcD,E,CACd,MAAO6D,GACPC,QAAQC,IAAIF,EAAMG,Q,KAV8B,CAClD,MAAMC,GAAU,EAAAC,EAAAC,4BAChBzE,EAAKK,aAAaI,UAAY8D,C,EAPlCG,G","sources":["node_modules/@parcel/runtime-js/lib/runtime-15cd39e06defd570.js","src/favorite-page.js","node_modules/@parcel/runtime-js/lib/runtime-643dfc921be0cb37.js","src/js/favorites.js"],"sourcesContent":["require('./helpers/bundle-manifest').register(JSON.parse(\"{\\\"bTGq4\\\":\\\"favorites-page.31bfe8be.js\\\",\\\"lp5u4\\\":\\\"sprite.f129be79.svg\\\",\\\"b3ZSW\\\":\\\"index.fec21257.js\\\"}\"));","import './js/header';\nimport './js/favorites-hero';\nimport './js/favorites';\nimport './js/create_order';\n","module.exports = new __parcel__URL__(require('./helpers/bundle-manifest').resolve(\"lp5u4\")).toString();","import axios from 'axios';\nimport svg from '../images/sprite.svg';\nimport { createPlugFavoriteMarkup } from './plug';\nimport { save, load, remove } from './localStorageJSON';\n\nconst refs = {\n  favoritesCategoriesList: document.querySelector('.favorites-category-list'),\n  favoritesRecipesList: document.querySelector('.favorites-recipes-list'),\n  emptyStorage: document.querySelector('.empty-storage-js'),\n};\n\nconst KEY_FAVOURITE = 'favourite';\nlet favCatArrObj = [];\n\nrefs.favoritesCategoriesList.addEventListener(\n  'click',\n  filterFavRecipeByCategory\n);\n\ncheckArrFavoritesId();\n\nasync function checkArrFavoritesId() {\n  const arrFavoritesId = load(KEY_FAVOURITE);\n\n  if (!arrFavoritesId || arrFavoritesId.length === 0) {\n    const markStr = createPlugFavoriteMarkup();\n    refs.emptyStorage.innerHTML = markStr;\n  } else {\n    try {\n      const recipesList = await fetchUsers(arrFavoritesId);\n      favCatArrObj = createFavCatArrObj(recipesList);\n      MarkUpFavSearch(favCatArrObj);\n      MarkUpRecipes(favCatArrObj);\n    } catch (error) {\n      console.log(error.message);\n    }\n  }\n}\n\nasync function fetchUsers(arrId) {\n  const BASE_URL_RECIPES =\n    'https://tasty-treats-backend.p.goit.global/api/recipes/';\n  try {\n    const arrOfPromises = arrId.map(async itemId => {\n      const response = await fetch(`${BASE_URL_RECIPES}${itemId}`);\n      return response.json();\n    });\n    const recipes = await Promise.allSettled(arrOfPromises);\n    return recipes.map(recipe => recipe.value);\n  } catch {\n    throw new Error('ERROR');\n  }\n}\n\nfunction createFavCatArrObj(recipesList) {\n  const favCatArr = [];\n  const uniqueCategories = [\n    ...new Set(recipesList.map(recipe => recipe.category)),\n  ];\n\n  uniqueCategories.forEach(category => {\n    const recipesInCategory = recipesList.filter(\n      recipe => recipe.category === category\n    );\n    favCatArr.push({ categ: category, recipes: recipesInCategory });\n  });\n\n  return favCatArr;\n}\n\nfunction MarkUpFavSearch(arr) {\n  const favSearchArr = arr.map(\n    ({ categ }) => ` <li class=\"fav-search-item\">\n          <button type=\"button\" class=\"fav-search-button\">${categ}</button>\n        </li>`\n  );\n  refs.favoritesCategoriesList.innerHTML = `<li class=\"fav-search-item\">\n          <button type=\"button\" class=\"fav-search-button all-category-btn\">All categories</button>\n        </li>${favSearchArr.join('')}`;\n}\n\nfunction filterFavRecipeByCategory(event) {\n  const selectedCategory = event.target.textContent;\n\n  if (selectedCategory === 'All categories') {\n    MarkUpRecipes(favCatArrObj);\n  } else {\n    const selectedCategoryObj = favCatArrObj.find(\n      obj => obj.categ === selectedCategory\n    );\n    MarkUpRecipes([selectedCategoryObj]);\n  }\n}\n\nfunction MarkUpRecipes(arr) {\n  refs.favoritesRecipesList.innerHTML = '';\n  const favorArr = arr.flatMap(({ recipes }) =>\n    recipes.map(({ _id, title, category, description, preview, rating }) => {\n      const activeStarMarkup = `<svg class=\"is-active-star\">\n      <use href=\"${svg}}#icon-star\"></use>\n    </svg>`;\n      const inactiveStarMarkup = `<svg class=\"dishes-list-star-icon\">\n      <use href=\"${svg}}#icon-star\"></use>\n    </svg>`;\n\n      function generateStars(rating) {\n        let stars = '';\n        let roundedRating = Math.round(rating);\n        for (let i = 0; i < 5; i++) {\n          stars += i < roundedRating ? activeStarMarkup : inactiveStarMarkup;\n        }\n        return stars;\n      }\n      return `<li class=\" dishes-list-item-fav\" data-id=\"${_id}\" data-category=\"${category}\" style=\"background: linear-gradient(1deg, rgba(5, 5, 5, 0.60) 0%, rgba(5, 5, 5, 0.00) 100%), url(${preview}); background-position: center;\n                      background-size: cover;\">\n        <button type=\"button\" aria-label=\"Favorite Button\" class=\"heart-btn js-favourite\" data-heart=\"heart\">\n        <svg class=\"dishes-list-heart-icon\">\n        <use href=\"${svg}#icon-heart\">\n        </use>\n    </svg>\n</button>\n          \n            <div class=\"dishes-list-item-wrapper-fav\">\n                <h3 class=\"dishes-list-item-title\">${title}</h3>\n                <p class=\"dishes-list-item-text-fav\">${description}</p>\n                <div class=\"dishes-list-item-wrapper-rating\">\n                    <div class=\"dishes-list-item-wrapper-rating-star\">\n                        <p class=\"dishes-list-item-wrapper-rating-text\">${rating.toFixed(\n                          1\n                        )}</p>\n                         <div class=\"dishes-list-item-wrapper-rating-star-5\">\n                            ${generateStars(rating)}\n                        </div>\n                    </div>\n                    </div>\n                    <button type=\"button\" data-id=\"${_id}\" data-modal-recipe-open class=\"see-recipe-btn js-see-recipe\">See recipe</button>\n                </div>\n            </div>\n        </li>`;\n    })\n  );\n  refs.favoritesRecipesList.innerHTML = favorArr.join('');\n}\n"],"names":["parcelRequire","register","JSON","parse","$a4212a039eccdb43$exports","URL","resolve","import","meta","url","toString","$7f07f86ee49d81c7$var$refs","favoritesCategoriesList","document","querySelector","favoritesRecipesList","emptyStorage","$7f07f86ee49d81c7$var$favCatArrObj","$7f07f86ee49d81c7$var$MarkUpRecipes","arr","innerHTML","favorArr","flatMap","recipes","map","_id","title","category","description","preview","rating","rating1","activeStarMarkup","$parcel$interopDefault","inactiveStarMarkup","toFixed","stars","roundedRating","Math","round","i","generateStars","join","addEventListener","event","selectedCategory","target","textContent","find","obj","categ","async","arrFavoritesId","$iELe5","load","length","recipesList","arrId","BASE_URL_RECIPES","arrOfPromises","itemId","fetch","json","Promise","allSettled","recipe","value","Error","$7f07f86ee49d81c7$var$fetchUsers","favCatArr","Set","forEach","recipesInCategory","filter","push","$7f07f86ee49d81c7$var$createFavCatArrObj","favSearchArr","$7f07f86ee49d81c7$var$MarkUpFavSearch","error","console","log","message","markStr","$ey8Ff","createPlugFavoriteMarkup","$7f07f86ee49d81c7$var$checkArrFavoritesId"],"version":3,"file":"favorites-page.31bfe8be.js.map"}